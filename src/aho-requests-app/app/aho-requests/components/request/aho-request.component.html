<div class="aho-request-details h-100 d-flex flex-column">
  <div mat-dialog-title class="mb-0">
    <div>
      <span class="request-title">Заявка №{{ ahoRequestsService.getSelectedRequest().id }}</span>
      <span class="request-date">от {{ ahoRequestsService.getSelectedRequest().dateCreated | date:'dd.MM.yyyy, HH:mm' }}</span>
    </div>
    <div class="user">Автор: {{ ahoRequestsService.getSelectedRequest().user.fio }}</div>
    <mat-divider class="mt-3"></mat-divider>
  </div>
  <mat-dialog-content>

    <mat-tab-group class="demo-tab-group" [dynamicHeight]="true" ngClass="h-100">

      <!-- Start: Содкржание заявки -->
      <mat-tab label="Содержание" class="mh-100">


        <!--
        <div class="author mt-2">
          <div class="label">Автор</div>
          <div class="value">{{ ahoRequestsService.getSelectedRequest().user.fio }}</div>
          <mat-divider class="mt-2 mb-2"></mat-divider>
        </div>
        -->

        <!-- Start: Категория заявки -->
        <!--
        <div class="request-type">
          <div class="label">Категория заявки</div>
          <div class="value">{{ ahoRequestsService.getSelectedRequest().type.title }}</div>
          <mat-divider class="mt-2 mb-2"></mat-divider>
        </div>
        -->
        <!-- End: Категория заявки -->

        <div class="container-fluid" *ngIf="ahoRequestsService.getSelectedRequest().tasks.length === 0">
          <div class="row">
            <div class="col-12 pt-3">
              <div class="label">Комментарий</div>
              <p class="comment lead pt-2 pl-4 pr-4 pb-2 text-center">{{ ahoRequestsService.getSelectedRequest().comment }}</p>
              <mat-divider></mat-divider>
            </div>
          </div>

          <div class="row">
            <div class="col-12 pt-3">
              <div class="label">Кабинет</div>
              <p class="room lead pt-2 pl-4 pr-4 pb-2 text-center">{{ ahoRequestsService.getSelectedRequest().room }}</p>
              <mat-divider></mat-divider>
            </div>
          </div>
        </div>

        <!-- Start: Список задач -->
        <div *ngIf="ahoRequestsService.getSelectedRequest().tasks.length > 0">
          <mat-selection-list>
            <mat-list-option *ngFor="let task of ahoRequestsService.getSelectedRequest().tasks"
                             [selected]="task.done">
              <span matLine>{{ task.content.title }}</span>
              <span matLine class="text-muted" *ngIf="ahoRequestsService.getSelectedRequest().type.isCountable">Количество: {{ task.count + ' ' + task.content.boxing }}</span>
            </mat-list-option>
          </mat-selection-list>
        </div>
        <!-- End: Список задач -->


      </mat-tab>
      <!-- End: Содержание заявки -->

      <!-- Start: Комментарии к заявке -->
      <mat-tab label="Комментарии">
        <div class="demo-tab-content">
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla venenatis ante augue.
          Phasellus volutpat neque ac dui mattis vulputate. Etiam consequat aliquam cursus.
          In sodales pretium ultrices. Maecenas lectus est, sollicitudin consectetur felis nec,
          feugiat ultricies mi. Aliquam erat volutpat. Nam placerat, tortor in ultrices porttitor,
          orci enim rutrum enim, vel tempor sapien arcu a tellus.
        </div>
      </mat-tab>
      <!-- End: Комментарии к заявке -->

      <!-- Start: История изменений заявки -->
      <mat-tab label="История изменений">
        <div class="demo-tab-content">
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla venenatis ante augue.
          Phasellus volutpat neque ac dui mattis vulputate. Etiam consequat aliquam cursus.
          In sodales pretium ultrices. Maecenas lectus est, sollicitudin consectetur felis nec,
          feugiat ultricies mi. Aliquam erat volutpat. Nam placerat, tortor in ultrices porttitor,
          orci enim rutrum enim, vel tempor sapien arcu a tellus.
          <br />
          <br />
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla venenatis ante augue.
          Phasellus volutpat neque ac dui mattis vulputate. Etiam consequat aliquam cursus.
          In sodales pretium ultrices. Maecenas lectus est, sollicitudin consectetur felis nec,
          feugiat ultricies mi. Aliquam erat volutpat. Nam placerat, tortor in ultrices porttitor,
          orci enim rutrum enim, vel tempor sapien arcu a tellus.
        </div>
      </mat-tab>
      <!-- End: История изменений заявки -->

    </mat-tab-group>

    <div *ngIf="authenticationService.getCurrentUser() && authenticationService.getCurrentUser().permissions.getByCode('allow_set_employee')">
      <mat-form-field class="w-100">
        <mat-select placeholder="Исполнитель">
          <mat-option *ngFor="let employee of ahoRequestsService.getEmployees()" [value]="employee">
            {{ employee.fio }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

  </mat-dialog-content>
  <mat-dialog-actions class="pt-3">
    <div class="container-fluid p-0">
      <div class="row">

        <!-- End: Кнопка добавления заявки -->
        <div class="col-12 col-md-6">
          <button mat-raised-button
                  type="submit"
                  [color]="'primary'"
                  class="w-100"
                  (click)="editRequest()">
            <div class="d-flex flex-row w-100 align-items-center" *ngIf="ahoRequestsService.isAddingRequest()">
              <mat-progress-spinner
                class="mr-2"
                [diameter]="20"
                [color]="'success'"
                [mode]="'indeterminate'">
              </mat-progress-spinner>
              Загрузка
            </div>
            <span *ngIf="!ahoRequestsService.isAddingRequest()">Сохранить изменения</span>
          </button>
        </div>
        <!-- End: Кнопка добавления заявки -->


        <!-- Start: Кнопка отмены -->
        <div class="col-12 col-md-6 pt-2 pt-md-0">
          <button mat-raised-button
                  routerLink="/"
                  [color]="'warn'"
                  class="w-100">
            Отмена
          </button>
        </div>
        <!-- End: Кнопка отмены -->

      </div>
    </div>





  </mat-dialog-actions>

</div>
