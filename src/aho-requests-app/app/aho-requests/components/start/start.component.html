<div class="container-fluid content-wrapper pb-3">

  <!--
  <div class="row pt-1 pt-sm-2 pt-md-3 justify-content-between">
    <div class=" col-12 col-sm-6 col-md-4 col-lg-3 col-xl-3 mb-2 mb-md-3" *ngFor="let requestType of ahoRequestsService.getRequestTypes()">
      <mat-card class="admin-type-card h-100">
        <span class="badge d-none d-md-inline">6</span>
        <div class="container-fluid">
          <div class="row">
            <div class="col-3 col-md-3">
              <mat-icon fontSet="fa" fontIcon="{{ requestType.icon }}"></mat-icon>
            </div>
            <div class="col type-title">
              <div>{{ requestType.title }}</div>
              <div class="text-muted d-md-none">
                <small>новых заявок: 5</small>
              </div>
            </div>
          </div>
        </div>
      </mat-card>
    </div>
  </div>
  -->

  <div class="row no-gutters pt-1 pt-sm-2 pt-md-3">
    <div class="col-12">
      <mat-table #table [dataSource]="ahoRequestsService.getDataSource()" class="aho-requests-table">

        <!-- Start: Request type column -->
        <ng-container matColumnDef="requestType">
          <mat-header-cell *matHeaderCellDef class="request-type-column d-none d-sm-flex"></mat-header-cell>
          <mat-cell *matCellDef="let element" class="request-type-column d-none d-sm-flex">
            <mat-icon
              [color]="'accent'"
              fontSet="fa"
              fontIcon="{{ element.type.icon }}"
              matTooltip="{{ element.type.title }}"
              [matTooltipPosition]="'right'">
            </mat-icon>
          </mat-cell>
        </ng-container>
        <!-- End: Request type column -->

        <!-- Start: Request id column -->
        <ng-container matColumnDef="id">
          <mat-header-cell *matHeaderCellDef class="request-id-column d-none d-sm-flex"> # </mat-header-cell>
          <mat-cell *matCellDef="let element" class="request-id-column d-none d-sm-flex"> {{ element.id }} </mat-cell>
        </ng-container>
        <!-- End: Request id column -->

        <!-- Start: Request user column -->
        <ng-container matColumnDef="user">
          <mat-header-cell *matHeaderCellDef class="request-user d-none d-sm-none d-md-flex ml-md-5"> Заявитель </mat-header-cell>
          <mat-cell *matCellDef="let element" class="request-user d-none d-sm-none d-md-flex ml-md-5"> {{ element.user.firstName + ' ' + element.user.lastName }} </mat-cell>
        </ng-container>
        <!-- End: Request user column -->

        <!-- Start: Request comment column -->
        <ng-container matColumnDef="description">
          <mat-header-cell *matHeaderCellDef> Содержание </mat-header-cell>
          <mat-cell *matCellDef="let request" class="pt-2 pb-2">
            <div *ngFor="let task of request.tasks">
              {{ task.content.title }} <span class="text-muted" *ngIf="request.type.isCountable">&nbsp; &mdash; &nbsp; {{ task.count  + ' ' + task.content.boxing }}</span>
            </div>
          </mat-cell>
        </ng-container>
        <!-- End: Request comment column -->

        <!-- Start: Request room column -->
        <ng-container matColumnDef="room">
          <mat-header-cell *matHeaderCellDef class="request-room-column"> Кабинет </mat-header-cell>
          <mat-cell *matCellDef="let element" class="request-room-column">{{ element.room !== '' ? element.room : '-' }}</mat-cell>
        </ng-container>
        <!-- End: Request room column -->

        <!-- Start: Request date column -->
        <ng-container matColumnDef="dateCreated">
          <mat-header-cell *matHeaderCellDef class="request-date-created-column d-none d-sm-none d-md-flex"> Дата подачи заявки </mat-header-cell>
          <mat-cell *matCellDef="let element" class="request-date-created-column d-none d-sm-none d-md-flex"> {{ element.dateCreated | date:'dd.MM.yyyy, HH:mm' }} </mat-cell>
        </ng-container>
        <!-- End: Request end column -->

        <!-- Start: Request employee column -->
        <ng-container matColumnDef="employee">
          <mat-header-cell *matHeaderCellDef class="d-none d-sm-none d-md-flex"> Исполнитель </mat-header-cell>
          <mat-cell *matCellDef="let task" class="d-none d-sm-none d-md-flex">
            <span class="text-muted" *ngIf="!task.employee">Не задан</span>
            <span *ngIf="task.employee">{{ task.employee.firstName + ' ' + task.employee.lastName }}</span>
          </mat-cell>
        </ng-container>
        <!-- End: Request employee column -->

        <!-- Start: Request status column -->
        <ng-container matColumnDef="requestStatus">
          <mat-header-cell *matHeaderCellDef class="request-status-column d-none d-sm-none d-md-flex"> Статус </mat-header-cell>
          <mat-cell *matCellDef="let element" class="request-status-column d-none d-sm-none d-md-flex">
            <mat-icon fontSet="fa"
                      fontIcon="{{ element.status.icon }}"
                      [style.color]="element.status.iconColor ? element.status.iconColor : 'black'"
                      *ngIf="element.status.icon"
                      matTooltip="{{element.status.title}}"
                      [matTooltipPosition]="'left'">
            </mat-icon>
          </mat-cell>
        </ng-container>
        <!-- End: Request status column -->

        <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
        <mat-row *matRowDef="let row; columns: displayedColumns; let i = index;" (click)="selectRequest(row)"></mat-row>
      </mat-table>


    </div>
  </div>
</div>


<button mat-fab
        [color]="'primary'"
        id="add-request-button"
        (click)="openNewRequestDialog()"
        *ngIf="authenticationService.getCurrentUser()"
        matTooltip="Подать заявку"
        [matTooltipPosition]="'left'">
  <mat-icon fontSet="fa" fontIcon="fa-plus"></mat-icon>
</button>
